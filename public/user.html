<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User Dashboard | IT Service Portal</title>
    <link rel="stylesheet" href="/css/styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="brand">
        <div class="logo-mark">IT</div>
        <div>
          <strong>IT Service Portal</strong>
          <div class="muted small">User Workspace</div>
        </div>
      </div>
      <nav class="topnav">
        <a href="/user-dashboard">Dashboard</a>
        <a href="/user">Tickets</a>
        <a href="/user-knowledge">Knowledge</a>
        <a href="/user-productivity">Productivity</a>
        <a href="/user-inventory">Inventory</a>
        <a href="/user-projects">Projects</a>
      </nav>
      <div class="topbar-actions">
        <button class="user-pill" id="user-menu-toggle" aria-haspopup="true" aria-expanded="false">
          <span class="avatar">IT</span>
          <div>
            <div id="admin-info-name"></div>
            <div class="muted small" id="admin-info-role"></div>
          </div>
          <span class="chevron">▾</span>
        </button>
        <div class="user-menu" id="user-menu" hidden>
          <a href="/user">Profile</a>
          <a href="/settings">Settings</a>
          <button id="logout-menu">Logout</button>
        </div>
      </div>
    </header>

    <main class="grid two-columns">
      <section class="card">
        <h2>New Ticket</h2>
        <form id="ticket-form">
          <label>
            Type
            <select name="type">
              <option value="incident">Incident</option>
              <option value="service">Service Request</option>
            </select>
          </label>
          <label>
            Category
            <select name="category">
              <option value="Network">Network</option>
              <option value="Accounts">Accounts</option>
              <option value="Hardware">Hardware</option>
              <option value="Software">Software</option>
              <option value="General" selected>General</option>
            </select>
          </label>
          <label>
            Priority
            <select name="priority">
              <option value="P1">P1 - Critical</option>
              <option value="P2">P2 - High</option>
              <option value="P3" selected>P3 - Medium</option>
              <option value="P4">P4 - Low</option>
            </select>
          </label>
          <label>
            Users Affected
            <input type="number" name="affected_users" min="1" value="1" />
          </label>
          <label>
            Business Critical?
            <select name="business_critical">
              <option value="false" selected>No</option>
              <option value="true">Yes</option>
            </select>
          </label>
          <label>
            Linked Change ID (optional)
            <input type="text" name="linked_change_id" placeholder="CHG000123" />
          </label>
          <label>
            Title
            <input type="text" name="title" placeholder="Email outage" required />
          </label>
          <label>
            Description
            <textarea name="description" rows="4" placeholder="What happened?"></textarea>
          </label>
          <div id="kb-suggestions" class="kb-suggestions"></div>
          <button class="button primary" type="submit">Submit</button>
          <p class="error" id="ticket-error"></p>
        </form>
      </section>

      <section class="card">
        <h2>My Tickets</h2>
        <div id="tickets"></div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="footer-brand">
        <div class="logo-mark">IT</div>
        <div>
          <strong>IT Service Portal</strong>
          <div class="muted small">Acme IT Operations</div>
        </div>
      </div>
      <div class="footer-meta">
        <div class="system-status">
          <div>API uptime: <span class="status-green" id="api-uptime">99.9%</span></div>
          <div>Last refresh: <span id="last-refresh">--</span></div>
          <div>Health: <span class="status-green" id="health-status">Green</span></div>
        </div>
        <div>123 Service Lane, Suite 400, New York, NY</div>
        <div>support@acmeitops.com • +1 (555) 123-4567</div>
        <div class="footer-links">
          <a href="/user-dashboard">Dashboard</a>
          <a href="/user">Tickets</a>
          <a href="/user-knowledge">Knowledge</a>
          <a href="/user-productivity">Productivity</a>
          <a href="/user-inventory">Inventory</a>
          <a href="/user-projects">Projects</a>
        </div>
        <div class="muted small">© 2025 IT Service Portal™</div>
      </div>
    </footer>

    <script src="/js/common.js"></script>
    <script src="/js/user.js"></script>
    <script>
      (async () => {
        await initHeader({ requireRole: 'user' });
      })();
    </script>
  </body>
</html>
